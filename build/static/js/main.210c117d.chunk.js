(window.webpackJsonp=window.webpackJsonp||[]).push([[0],{207:function(e,t){e.exports="data:image/png;base64,iVBORw0KGgoAAAANSUhEUgAAASAAAAEgCAYAAAAUg66AAAALC0lEQVR4nO3da1caBwLG8cdBAQHBFnMELznd3aTdGtv9/p+iSWPq5rLpVhS8YAMid4F9kSbdNu0x2jDPjPP/vckbDzwH5X+AMDMLZ+etmQDAIHAPAJBcBAiADQECYEOAANgQIAA2BAiADQECYEOAANgQIAA2BAiADQECYEOAANgQIAA2BAiADQECYEOAANgQIAA2BAiADQECYEOAANgQIAA2BAiADQECYEOAANgQIAA2BAiADQECYEOAANgQIAA2BAiADQECYEOAANgQIAA2BAiADQECYEOAANgQIAA2BAiADQECYEOAANgQIAA2BAiADQECYEOAANgQIAA2BAiADQECYEOAANgQIAA2BAiADQECYEOAANgQIAA2BAiADQECYEOAANgQIAA2BAiADQECYEOAANgQIAA2BAiADQECYEOAANgQIAA2BAiADQECYEOAANgQIAA2BAiADQECYEOAANgQIAA2BAiADQECYEOAANgQIAA2BAiADQECYEOAANgQIAA2BAiADQECYEOAANgQIAA2BAiADQECYEOAANgQIAA2BAiADQECYEOAANgQIAA2BAiADQECYLPoHoB46Pf7anc6urzoqN3pqNvpaDKb/eZngiBQoZBXaaWoQnFFpZUVLS8vmxYjDhbOzluz638MSTSdTnV8eqparaZer3+r2yjkctrc3tL6+rpSCwufeCHijgDhA5PJREeNhmq1Q41Go09ym+l0WtvbW9qsVpVKpT7JbSL+CBDem0wmOqzXdXhQ0+jqai73sbS09DZEm5taDPgIMukIECRJ3W5P3+/taTAYhHJ/2WxW3+7uKp/PhXJ/iCYCBJ2fn2vvh31Np9NQ7zcIAu3ufK1yuRzq/SI6eA2ccI1GQ3t7z0KPj/T2Q+69vWeq1+uh3zeigQAlWP34WP9+8VLhp+dXU0nPX75S/fjYuAIuBCihms1zvXz+wj3jvZfPX6jZPHfPQMgIUAL1ej0929+3vvL5vamkZ/v76vV67ikIEQFKmHefuzg+87lOlLdhPghQwhwc1NTt3+5bzWHo9vs6OKi5ZyAkBChBhsOhfqpF/8n9U62m4XDonoEQEKAEOTg8jMXbm+l0qoPDQ/cMhIAAJcRkMlG93nDP+GiNxrEmk4l7BuaMACVE4+Qk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"},209:function(e,t,a){e.exports=a.p+"static/media/lock.c6371603.svg"},215:function(e,t,a){e.exports=a(578)},250:function(e,t,a){},347:function(e,t,a){e.exports=a.p+"static/media/hashtag_icon.f013a499.png"},578:function(e,t,a){"use strict";a.r(t);a(216),a(240);var n=a(0),i=a.n(n),r=a(39),s=a.n(r),l=a(44),o=a.n(l),c=a(7),u=a(8),d=a(10),h=a(9),g=a(11),p=a(1),b=(a(248),a(250),a(15)),m=a.n(b),A=a(16),f=a.n(A),v=a(14),E=a.n(v),w=(Object(p.platform)(),function(e){function t(e){return Object(c.a)(this,t),Object(d.a)(this,Object(h.a)(t).call(this,e))}return Object(g.a)(t,e),Object(u.a)(t,[{key:"render",value:function(){var e=this;return window.getGlobalState().currentSubscribtion?setTimeout(function(){return e.props.open("feed")}):setTimeout(function(){return e.props.open("subscribe")}),i.a.createElement(p.Panel,{id:this.props.id},i.a.createElement(p.Div,null,i.a.createElement(p.Spinner,null)))}}]),t}(i.a.Component)),S=a(45),y=a(206),k=a.n(y),C=a(122),O=a.n(C),D=function(){var e={};if(window.location.hash.length>0){var t=window.location.hash.substr(1),a=!0,n=!1,i=void 0;try{for(var r,s=t.split("&")[Symbol.iterator]();!(a=(r=s.next()).done);a=!0){var l=r.value;l.includes("=")&&(e[l.split("=")[0]]=l.split("=")[1])}}catch(o){n=!0,i=o}finally{try{a||null==s.return||s.return()}finally{if(n)throw i}}}return e},T=function(e){return e.charAt(0).toUpperCase()+e.slice(1)},j=function(e){var t=["2770f1","3fb0ac","ba9077","729f98","6534ff","62bcfa","e05038","dc3966","026f52","f36523","e70247","07a5a4","4bae54","c75696","db3849"],a=0;return e.split("").forEach(function(n,i){a=17*a+e.charCodeAt(i),i%4==3&&(a%=t.length)}),"#"+t[a%t.length]},B=function(e){!function(e){var t="";for(var a in e)t+=a+"="+e[a]+"&";var n=t.substring(0,t.length-1);o.a.send("VKWebAppSetLocation",{location:n}),window.location.hash="#"+n}(Object.assign(D(),e))},N=function(e){function t(){return Object(c.a)(this,t),Object(d.a)(this,Object(h.a)(t).apply(this,arguments))}return Object(g.a)(t,e),Object(u.a)(t,[{key:"render",value:function(){var e=this,t=this.props.tags,a=this.props.selectedTags;return i.a.createElement(p.HorizontalScroll,null,t.map(function(t){var n={};return n="undefined"==typeof a||a.includes(t)?{margin:"0 5px",background:j(t),color:"white"}:{margin:"0 5px",background:"rgba(1, 1, 1, 0)",color:j(t),boxShadow:"inset 0px 0px 0px 1px "+j(t)},i.a.createElement(p.Button,{onClick:function(){return e.props.toggleTag(t)},style:n},"#",t)}))}}]),t}(i.a.Component),P=function(){function e(t,a){switch(Object(c.a)(this,e),typeof t){case"undefined":this.dateJS=new Date;break;case"string":if(0==t.length){this.dateJS=new Date;break}if(!t.includes(".")&&!t.includes("/")&&!t.includes("-")){this.dateJS=new Date(parseInt(t));break}var n;n="."==t[2]||"/"==t[2]||"-"==t[2]?t.substring(3,5)+"/"+t.substring(0,2)+"/"+t.substring(6,10):":"!=t[2]||"."!=t[8]&&"/"!=t[8]&&"-"!=t[8]?t:t.substring(0,6)+t.substring(9,11)+"/"+t.substring(6,8)+"/"+t.substring(12,16),this.dateJS=new Date(Date.parse(n));break;case"number":this.dateJS=new Date(t);break;case"object":this.dateJS=new Date(t.dateJS);break;default:this.dateJS=new Date}switch(a){case"RU":this.lang=a;break;default:this.lang="ENG"}}return Object(u.a)(e,[{key:"setDate",value:function(t){this.dateJS=new e(t)}},{key:"getTime",value:function(){return this.dateJS.getTime()}},{key:"comp",value:function(t){return new e(t).getTime()-this.dateJS.getTime()}},{key:"less",value:function(t){var a=new e(t);return this.dateJS.getTime()<a.getTime()}},{key:"eq",value:function(e){var t=new Date(e);return this.dateJS.getDate()<t.getDate()&&this.dateJS.getMonth()<t.getMonth()&&this.dateJS.getFullYear()<t.getFullYear()}},{key:"sameDay",value:function(t){var a=new e(t);return this.day()==a.day()&&this.month()==a.month()&&this.year()==a.year()}},{key:"addDay",value:function(e){this.dateJS.setDate(this.dateJS.getDate()+e)}},{key:"addMonth",value:function(e){this.dateJS.setMonth(this.dateJS.getMonth()+e)}},{key:"addYear",value:function(e){this.dateJS.setFullYear(this.dateJS.getFullYear()+e)}},{key:"addMinute",value:function(e){this.dateJS.setMinutes(this.dateJS.getMinutes()+e)}},{key:"addHour",value:function(e){this.dateJS.setHours(this.dateJS.getHours()+e)}},{key:"toString",value:function(){return this.dateJS.getDate()+" "+this.monthString()+" "+this.dateJS.getFullYear()}},{key:"toStringShort",value:function(){return this.dateJS.getDate()+" "+this.monthStringShort()+" "+this.dateJS.getFullYear()}},{key:"toStringDot",value:function(){return(this.dateJS.getDate()<10?"0":"")+this.dateJS.getDate()+"."+((this.dateJS.getMonth()+1<10?"0":"")+(this.dateJS.getMonth()+1))+"."+this.dateJS.getFullYear()}},{key:"toStringSlash",value:function(){return(this.dateJS.getDate()<10?"0":"")+this.dateJS.getDate()+"."+((this.dateJS.getMonth()+1<10?"0":"")+(this.dateJS.getMonth()+1))+"."+this.dateJS.getFullYear()}},{key:"toStringDash",value:function(){return(this.dateJS.getDate()<10?"0":"")+this.dateJS.getDate()+"."+((this.dateJS.getMonth()+1<10?"0":"")+(this.dateJS.getMonth()+1))+"."+this.dateJS.getFullYear()}},{key:"date",value:function(){switch(this.lang){case"RU":return this.day()+" "+this.monthString();default:return this.monthString()+" "+this.day()}}},{key:"dateTime",value:function(){return this.time()+" "+T(this.date())}},{key:"day",value:function(){return this.dateJS.getDate()}},{key:"month",value:function(){return this.dateJS.getMonth()+1}},{key:"monthString",value:function(){switch(this.lang){case"RU":return["\u044f\u043d\u0432\u0430\u0440\u044f","\u0444\u0435\u0432\u0440\u0430\u043b\u044f","\u043c\u0430\u0440\u0442\u0430","\u0430\u043f\u0440\u0435\u043b\u044f","\u043c\u0430\u044f","\u0438\u044e\u043d\u044f","\u0438\u044e\u043b\u044f","\u0430\u0432\u0433\u0443\u0441\u0442\u0430","\u0441\u0435\u043d\u0442\u044f\u0431\u0440\u044f","\u043e\u043a\u0442\u044f\u0431\u0440\u044f","\u043d\u043e\u044f\u0431\u0440\u044f","\u0434\u0435\u043a\u0430\u0431\u0440\u044f"][this.month()-1];default:return["january","february","march","aprill","may","june","july","august","september","october","november","december"][this.month()-1]}}},{key:"monthStringShort",value:function(){switch(this.lang){case"RU":return["\u044f\u043d\u0432","\u0444\u0435\u0432","\u043c\u0430\u0440\u0442","\u0430\u043f\u0440","\u043c\u0430\u044f","\u0438\u044e\u043d","\u0438\u044e\u043b","\u0430\u0432\u0433","\u0441\u0435\u043d\u0442","\u043e\u043a\u0442","\u043d\u043e\u044f\u0431","\u0434\u0435\u043a"][this.month()-1];default:return["jan","feb","mar","apr","may","jun","jul","aug","sep","oct","nov","dec"][this.month()-1]}}},{key:"year",value:function(){return this.dateJS.getFullYear()}},{key:"time",value:function(){switch(this.lang){case"RU":return(this.dateJS.getHours()<10?"0":"")+this.dateJS.getHours()+":"+(this.dateJS.getMinutes()<10?"0":"")+this.dateJS.getMinutes();default:return(this.dateJS.getHours()<10?"0":"")+(this.dateJS.getHours()>12?this.dateJS.getHours()-12:this.dateJS.getHours())+":"+(this.dateJS.getMinutes()<10?"0":"")+this.dateJS.getMinutes()+(this.dateJS.getHours()>12?" pm":" am")}}},{key:"niceTime",value:function(){if(this.isToday())return this.time();if(this.isYesterday())switch(this.lang){case"RU":return"\u0432\u0447\u0435\u0440\u0430";default:return"yesterday"}return(new e).year()==this.year()?T(this.date()):this.day()+" "+this.monthString()+" "+this.year()}},{key:"hour",value:function(){return this.dateJS.getHours()}},{key:"minute",value:function(){return this.dateJS.getMinutes()}},{key:"isToday",value:function(){var t=new e;return t.day()==this.day()&&t.month()==this.month()&&t.year()==this.year()}},{key:"isYesterday",value:function(){var t=new e;return t.day()-1==this.day()&&t.month()==this.month()&&t.year()==this.year()}},{key:"isTomorrow",value:function(){var t=new e;return t.day()+1==this.day()&&t.month()==this.month()&&t.year()==this.year()}},{key:"pastSeconds",value:function(){var t=new e;return Math.floor((t.getTime()-this.getTime())/864e5*24*60*60)}},{key:"pastMinutes",value:function(){var t=new e;return Math.floor((t.getTime()-this.getTime())/864e5*24*60)}},{key:"pastHours",value:function(){var t=new e;return Math.floor((t.getTime()-this.getTime())/864e5*24)}},{key:"pastDays",value:function(){var t=new e;return Math.floor((t.getTime()-this.getTime())/864e5)}},{key:"pastWeeks",value:function(){var t=new e;return Math.floor((t.getTime()-this.getTime())/864e5/7)}},{key:"pastMonths",value:function(){var t=new e,a=t.month()-this.month()+12*(t.year()-this.year());return a>0&&this.day()>t.day()?a-1:a<0&&this.day()<t.day()?a+1:a}},{key:"pastYears",value:function(){return Math.floor(this.pastMonths()/12)}},{key:"countable",value:function(e,t){return e+" "+(Array.isArray(t)?e>10&&e<20||e%10>4||e%10==0?t[2]:e%10>1?t[1]:t[0]:1==e?t:t+"s")}},{key:"pastNice",value:function(){return this.pastSeconds()<60?this.countable(this.pastSeconds(),"RU"==this.lang?["\u0441\u0435\u043a\u0443\u043d\u0434\u0443","\u0441\u0435\u043a\u0443\u043d\u0434\u044b","\u0441\u0435\u043a\u0443\u043d\u0434"]:"second"):this.pastMinutes()<60?this.countable(this.pastMinutes(),"RU"==this.lang?["\u043c\u0438\u043d\u0443\u0442\u0443","\u043c\u0438\u043d\u0443\u0442\u044b","\u043c\u0438\u043d\u0443\u0442"]:"minute"):this.pastHours()<24?this.countable(this.pastHours(),"RU"==this.lang?["\u0447\u0430\u0441","\u0447\u0430\u0441\u0430","\u0447\u0430\u0441\u043e\u0432"]:"hour"):this.pastDays()<7?this.countable(this.pastDays(),"RU"==this.lang?["\u0434\u0435\u043d\u044c","\u0434\u043d\u044f","\u0434\u043d\u0435\u0439"]:"day"):this.pastMonths()<1?this.countable(this.pastWeeks(),"RU"==this.lang?["\u043d\u0435\u0434\u0435\u043b\u044e","\u043d\u0435\u0434\u0435\u043b\u0438","\u043d\u0435\u0434\u0435\u043b\u044c"]:"week"):this.pastYears()<1?this.countable(this.pastMonths(),"RU"==this.lang?["\u043c\u0435\u0441\u044f\u0446","\u043c\u0435\u0441\u044f\u0446\u0430","\u043c\u0435\u0441\u044f\u0446\u0435\u0432"]:"month"):this.countable(this.pastYears(),"RU"==this.lang?["\u0433\u043e\u0434","\u0433\u043e\u0434\u0430","\u043b\u0435\u0442"]:"year")}},{key:"dayOfWeek",value:function(){switch(this.lang){case"RU":return["\u0412\u043e\u0441\u043a\u0440\u0435\u0441\u0435\u043d\u044c\u0435","\u041f\u043e\u043d\u0435\u0434\u0435\u043b\u044c\u043d\u0438\u043a","\u0412\u0442\u043e\u0440\u043d\u0438\u043a","\u0421\u0440\u0435\u0434\u0430","\u0427\u0435\u0442\u0432\u0435\u0440\u0433","\u041f\u044f\u0442\u043d\u0438\u0446\u0430","\u0421\u0443\u0431\u0431\u043e\u0442\u0430"][this.dateJS.getDay()];default:return["Sunday","Monday","Tuesday","Wednesday","Thursday","Friday","Saturday"][this.dateJS.getDay()]}}},{key:"dayOfWeekShort",value:function(){switch(this.lang){case"RU":return["\u0412\u0441","\u041f\u043d","\u0412\u0442","\u0421\u0440","\u0427\u0442","\u041f\u0442","\u0421\u0431"][this.dateJS.getDay()];default:return["Sun","Mon","Tue","Wed","Thu","Fri","Sat"][this.dateJS.getDay()]}}}]),e}(),G=a(207),I=a.n(G),M=(a(347),a(208)),Q=a.n(M),F=Object(p.platform)(),J=function(e){function t(e){var a;return Object(c.a)(this,t),(a=Object(d.a)(this,Object(h.a)(t).call(this,e))).state={articles:null,searchQuery:"",selectedTags:[],popularTags:[],isUserPublisher:!1},a}return Object(g.a)(t,e),Object(u.a)(t,[{key:"componentDidMount",value:function(){var e=this;E.a.get("".concat(window.getGlobalState().apiUrl,"/tagsAndPublishers")).then(function(t){var a=t.data.result.publishers;e.setState({isUserPublisher:a.filter(function(e){return e.userProfile.id==window.getGlobalState().auth.id}).length>0})}).catch(console.log);var t=window.getGlobalState(),a="";a=t.previewFeedMode&&t.previewFeedMode.tags.length+t.previewFeedMode.publishers.length>0?"".concat(window.getGlobalState().apiUrl,"/allArticles?userId=").concat(window.getGlobalState().auth.id,"&signedUserId=").concat(window.getGlobalState().auth.signed_user_id)+(t.previewFeedMode.tags.length>0?"&tags=".concat(t.previewFeedMode.tags.join(",")):"")+(t.previewFeedMode.publishers.length>0?"&publishers=".concat(t.previewFeedMode.publishers.join(",")):""):"".concat(window.getGlobalState().apiUrl,"/articles?userId=").concat(window.getGlobalState().auth.id,"&signedUserId=").concat(window.getGlobalState().auth.signed_user_id),E.a.get(a).then(function(t){e.setState({articles:t.data.result.articles});var a=[];t.data.result.articles.forEach(function(e){e.tags.forEach(function(e){var t=a.findIndex(function(t){return t.tag==e});-1===t?a.push({tag:e,popularity:1}):a=Object(S.a)(a.slice(0,t)).concat([{tag:e,popularity:a[t].popularity+1}],Object(S.a)(a.slice(t+1)))})}),a=a.sort(function(e,t){return t.popularity-e.popularity}).filter(function(e){return e.popularity>1}).map(function(e){return e.tag}),e.setState({popularTags:a})}).catch(function(t){console.log(t),e.setState({articles:[]})})}},{key:"toggleTag",value:function(e){var t=this.state.selectedTags,a=this.state.selectedTags.indexOf(e);-1==a?t.push(e):t=Object(S.a)(t.slice(0,a)).concat(Object(S.a)(t.slice(a+1))),this.setState({selectedTags:t})}},{key:"renderArticleListing",value:function(e){var t=this,a=new P(e.date,"RU");return i.a.createElement(p.Group,null,i.a.createElement(p.Div,{onClick:function(){B({article:e.id}),t.props.open("article")}},i.a.createElement("div",{className:"article-publisher"},i.a.createElement("div",{className:"publisher-avatar"},i.a.createElement("img",{src:I.a})),i.a.createElement("div",{className:"publisher-info"},i.a.createElement("div",{className:"publisher-name"},e.publisher),i.a.createElement("div",{className:"publishing-time"},a.pastNice()," \u043d\u0430\u0437\u0430\u0434"))),i.a.createElement("h3",{style:{margin:"0px 0"}},e.title)),i.a.createElement(p.Cell,{style:{padding:"2px 0 7px"}},i.a.createElement(N,{tags:e.tags,selectedTags:this.state.selectedTags,toggleTag:function(e){t.toggleTag(e)}})))}},{key:"renderArticles",value:function(){var e=this;return null==this.state.articles||void 0==this.state.articles?i.a.createElement(p.Div,null,i.a.createElement(p.Spinner,null)):0==this.state.articles.length?i.a.createElement(p.Footer,null,"\u043d\u0435\u0442 \u043d\u043e\u0432\u043e\u0441\u0442\u0435\u0439"):this.state.articles.filter(function(t){return(e.state.selectedTags.map&&0==e.state.selectedTags.length||e.state.selectedTags.map(function(e){return t.tags.includes(e)}).reduce(function(e,t){return e||t}))&&(t.title.includes(e.state.searchQuery)||t.tags.map(function(t){return t.includes(e.state.searchQuery)}).reduce(function(e,t){return e||t})||t.publisher.toLowerCase().includes(e.state.searchQuery))}).map(function(t){return e.renderArticleListing(t)})}},{key:"render",value:function(){var e=this;return i.a.createElement(p.Panel,{id:"feed"},i.a.createElement(p.PanelHeader,{left:i.a.createElement(p.HeaderButton,{onClick:function(){window.getGlobalState().previewFeedMode?(window.setGlobalState({previewFeedMode:!1}),e.props.goBack()):e.props.open("subscribe")}},window.getGlobalState().previewFeedMode?F===p.IOS?i.a.createElement(m.a,null):i.a.createElement(f.a,null):i.a.createElement("div",{className:"settings-icon-container"},i.a.createElement(k.a,null))),noShadow:!0},window.getGlobalState().previewFeedMode?"\u041f\u0440\u0435\u0432\u044c\u044e \u043d\u043e\u0432\u043e\u0441\u0442\u0435\u0439":i.a.createElement(i.a.Fragment,null,this.state.isUserPublisher&&i.a.createElement(Q.a,{className:"account-icon",onClick:function(){return e.props.open("publisher-account")}})," \u041d\u043e\u0432\u043e\u0441\u0442\u0438")),i.a.createElement(p.Search,{theme:"default",placeholder:"\u041f\u043e\u0438\u0441\u043a \u043f\u043e \u043f\u043e\u0441\u0442\u0430\u043c",onChange:function(t){return e.setState({value:t})}}),i.a.createElement(p.Div,null,i.a.createElement("small",null,"\u041f\u043e\u043f\u0443\u043b\u044f\u0440\u043d\u044b\u0435 \u0442\u0435\u0433\u0438:")),i.a.createElement(p.Cell,{style:{padding:"0"}},i.a.createElement(N,{tags:this.state.popularTags,selectedTags:this.state.selectedTags,toggleTag:function(t){e.toggleTag(t)}})),this.renderArticles())}}]),t}(i.a.Component),U=(a(348),a(209)),x=a.n(U),Y=(Object(p.platform)(),function(e){function t(e){return Object(c.a)(this,t),Object(d.a)(this,Object(h.a)(t).call(this,e))}return Object(g.a)(t,e),Object(u.a)(t,[{key:"render",value:function(){var e=this;return i.a.createElement(p.Div,null,i.a.createElement("img",{className:"lock-icon",src:x.a}),i.a.createElement(p.Div,{className:"payWall-title"},"\u0412\u044b \u0432\u0438\u0434\u0435\u0442\u0435 \u0442\u043e\u043b\u044c\u043a\u043e ",this.props.part?this.props.part+"%":"\u0447\u0430\u0441\u0442\u044c"," \u0441\u0442\u0430\u0442\u044c\u0438,",i.a.createElement("br",null),"\u0447\u0442\u043e\u0431\u044b  \u043f\u0440\u043e\u0447\u0438\u0442\u0430\u0442\u044c \u0435\u0451 \u043f\u043e\u043b\u043d\u043e\u0441\u0442\u044c\u044e \u0432\u044b \u043c\u043e\u0436\u0435\u0442\u0435:"),i.a.createElement(p.Div,{className:"double-buttons"},i.a.createElement(p.Button,{level:"outline",onClick:function(){return e.props.goToGetArticlePage()}},"\u041f\u043e\u043b\u0443\u0447\u0438\u0442\u044c \u0434\u043e\u0441\u0442\u0443\u043f \u043a \u044d\u0442\u043e\u0439 \u0441\u0442\u0430\u0442\u044c\u0435"),i.a.createElement(p.Button,{onClick:function(){return e.props.goToSubscribePage()}},"\u041e\u0444\u043e\u0440\u043c\u0438\u0442\u044c \u0433\u0438\u0431\u043a\u0443\u044e \u043f\u043e\u0434\u043f\u0438\u0441\u043a\u0443")))}}]),t}(i.a.Component)),L={article:{},subscribingProcess:{selected:{tags:[],publishers:[]},periodType:1},apiUrl:"https://agentstvo-adv.ru:3000/api",previewFeedMode:!1},H=i.a.createContext(L),W=function(e){function t(e){var a;return Object(c.a)(this,t),(a=Object(d.a)(this,Object(h.a)(t).call(this,e))).state=L,window.setGlobalState=function(e){"function"===typeof e?a.setState(e(Object.assign({},a.state))):a.setState(e)},window.getGlobalState=function(){return Object.assign({},a.state)},a}return Object(g.a)(t,e),Object(u.a)(t,[{key:"componentDidMount",value:function(){this.setState(L)}},{key:"render",value:function(){return i.a.createElement(H.Provider,{value:this.state},this.props.children)}}]),t}(i.a.Component),q={Consumer:H.Consumer,Provider:W},R=Object(p.platform)(),V=function(e){function t(e){var a;return Object(c.a)(this,t),(a=Object(d.a)(this,Object(h.a)(t).call(this,e))).state={article:null},a}return Object(g.a)(t,e),Object(u.a)(t,[{key:"componentDidMount",value:function(){var e=this,t=D();void 0===t.article||null!==this.state.article&&this.state.article.id===t.article||E.a.get("".concat(window.getGlobalState().apiUrl,"/article?userId=").concat(window.getGlobalState().auth.id,"&signedUserId=").concat(window.getGlobalState().auth.signed_user_id,"&articleId=").concat(t.article)).then(function(t){var a=t.data.result.article;e.setState({article:a});var n={article:{tags:a.tags,publisher:a.publisher,title:a.title,price:a.price}};window.getGlobalState().subscribingProcess.manuallyChanged||(n.subscribingProcess={selected:{tags:a.tags,publishers:[a.publisher]}}),n.subscribingProcess.periodType=window.getGlobalState().subscribingProcess.periodType,window.setGlobalState(n)}).catch(function(t){console.log(t),e.setState({article:{title:"\u0423\u043f\u0441...",paragraphs:"# \u041f\u0440\u043e\u0438\u0437\u043e\u0448\u043b\u0430 \u043e\u0448\u0438\u0431\u043a\u0430 \\n\\n \u0434\u0435\u0442\u0430\u043b\u0438 \u0432 \u043a\u043e\u043d\u0441\u043e\u043b\u0438"}})})}},{key:"genArticle",value:function(){var e=this;return i.a.createElement(i.a.Fragment,null,i.a.createElement(p.Div,null,this.state.article.paragraphs.substr&&i.a.createElement(O.a,{source:this.state.article.paragraphs.replace(/\\n/g,"\n")})),this.state.article.payWall<100&&i.a.createElement(Y,{part:this.state.article.payWall,goToGetArticlePage:function(){return e.props.open("get-one-article")},goToSubscribePage:function(){return e.props.open("subscribe")}}))}},{key:"render",value:function(){return console.log(this.state.article),i.a.createElement(p.Panel,{id:this.props.id},i.a.createElement(p.PanelHeader,{left:i.a.createElement(p.HeaderButton,{onClick:this.props.goBack},R===p.IOS?i.a.createElement(m.a,null):i.a.createElement(f.a,null))},this.state.article?this.state.article.title:"\u0417\u0430\u0433\u0440\u0443\u0437\u043a\u0430 \u0441\u0442\u0430\u0442\u044c\u0438..."),this.state.article&&this.state.article.paragraphs?i.a.createElement(p.Group,null,this.genArticle()):i.a.createElement(p.Div,null,i.a.createElement(p.Spinner,null)))}}]),t}(i.a.Component),X=a(68),z=a(210),K=a.n(z),Z=a(211),_=a.n(Z),$=["\u041d\u0435\u0434\u0435\u043b\u044f","\u0414\u0432\u0435 \u043d\u0435\u0434\u0435\u043b\u0438","\u041c\u0435\u0441\u044f\u0446","6 \u041c\u0435\u0441\u044f\u0446\u0435\u0432","\u0413\u043e\u0434","5 \u043b\u0435\u0442"],ee=function(e){function t(e){var a;return Object(c.a)(this,t),(a=Object(d.a)(this,Object(h.a)(t).call(this,e))).handleScroll=a.handleScroll.bind(Object(X.a)(Object(X.a)(a))),a.state={code:"",tab:"publishers",searchOpened:!1,filter:"",tags:[{label:"\u043f\u043e\u043b\u0438\u0442\u0438\u043a\u0430",pic:"https://www.telegraf-spb.ru/published/publicdata/B622311/attachments/SC/products_pictures/united-states-flag_enl.jpg",description:"Lorem ipsum dolor sit amet",subscribers:10,publishers:["\u0411\u0443\u043c\u0430\u0433\u0430","\u041b\u0435\u043d\u0442\u0430\u0447"],price:123}],publishers:[{label:"\u0411\u0443\u043c\u0430\u0433\u0430",pic:"https://www.telegraf-spb.ru/published/publicdata/B622311/attachments/SC/products_pictures/united-states-flag_enl.jpg",description:"\u0411\u0443\u043c\u0430\u0433\u0430, \u0440\u0432\u0451\u0442\u0441\u044f, \u0433\u043e\u0440\u0438\u0442, \u0434\u0435\u043b\u0430\u0435\u0442\u0441\u044f \u0438\u0437 \u0442\u0440\u0451\u0445 \u0442\u0440\u043e\u0441\u0442\u043d\u0438\u043a\u043e\u0432",subscribers:11,price:123}]},a}return Object(g.a)(t,e),Object(u.a)(t,[{key:"subscribe",value:function(){var e,t=this,a=window.getGlobalState().subscribingProcess;E.a.post(window.getGlobalState().apiUrl+"/subscriptions",{subscriptions:{tags:a.selected.tags,publishers:a.selected.publishers,endDate:new Date(Date.now()+(e=a.periodType,1===e?6048e5:2===e?12096e5:3===e?2592e6:4===e?15552e6:5===e?31104e6:0)).getTime(),autoDeposit:!0},userId:window.getGlobalState().auth.id,signedUserId:window.getGlobalState().auth.signed_user_id}).then(function(){t.props.goBack()}).catch(console.log)}},{key:"componentDidMount",value:function(){var e=this;window.addEventListener("scroll",this.handleScroll),E.a.get("".concat(window.getGlobalState().apiUrl,"/tagsAndPublishers")).then(function(t){e.setState({tags:t.data.result.tags.map(function(e){return e.price=Math.round(20*Math.random()*100)/100+2,e}),publishers:t.data.result.publishers.map(function(e){return e.price=Math.round(20*Math.random()*100)/100+2,e})})}).catch(console.log),E.a.get()}},{key:"componentWillUnmount",value:function(){window.removeEventListener("scroll",this.handleScroll)}},{key:"handleScroll",value:function(){window.pageYOffset>73?!this.state.fixedOverlay&&this.setState({fixedOverlay:!0}):this.state.fixedOverlay&&this.setState({fixedOverlay:!1})}},{key:"renderTabs",value:function(){var e=this;return i.a.createElement(p.Tabs,null,i.a.createElement(p.TabsItem,{onClick:function(){return e.setState({tab:"publishers"})},selected:"publishers"===this.state.tab},"\u0410\u0432\u0442\u043e\u0440\u0441\u043a\u0438\u0435 \u0440\u0430\u0441\u0441\u044b\u043b\u043a\u0438 ",""===this.state.filter?"":"("+this.state.publishers.filter(function(t){return t.label.toLowerCase().includes(e.state.filter.toLowerCase())}).length+")"),i.a.createElement(p.TabsItem,{onClick:function(){return e.setState({tab:"tags"})},selected:"tags"===this.state.tab},"Smart-\u0422\u0435\u0433\u0438 ",""===this.state.filter?"":"("+this.state.tags.filter(function(t){return t.label.toLowerCase().includes(e.state.filter.toLowerCase())}).length+")"))}},{key:"render",value:function(){var e=this;return i.a.createElement(q.Consumer,null,function(t){var a=t.subscribingProcess;console.log(a);var n=0,r=0;return a.selected.publishers.length+a.selected.tags.length>1&&(r=(a.selected.publishers.length+a.selected.tags.length)/15)>.5&&(r=.5),i.a.createElement(p.Panel,{id:e.props.id},i.a.createElement(p.PanelHeader,{left:i.a.createElement(p.HeaderButton,{onClick:e.props.goBack},p.osname===p.IOS?i.a.createElement(m.a,null):i.a.createElement(f.a,null)),noShadow:!0,right:i.a.createElement(p.HeaderButton,{onClick:e.props.goBack},i.a.createElement(K.a,null))},"\u0413\u0438\u0431\u043a\u0430\u044f \u043f\u043e\u0434\u043f\u0438\u0441\u043a\u0430"),i.a.createElement(p.FixedLayout,{style:e.state.fixedOverlay||""!==e.state.filter?{opacity:1,transition:".3s all",pointerEvents:"all"}:{opacity:0,transition:".3s all",pointerEvents:"none"}},i.a.createElement(p.Search,{placeholder:"\u041f\u043e\u0438\u0441\u043a \u043f\u043e "+("tags"===e.state.tab?"\u0441\u043c\u0430\u0440\u0442-\u0442\u0435\u0433\u0430\u043c":"\u0430\u0432\u0442\u043e\u0440\u0441\u043a\u0438\u043c \u043a\u0430\u043d\u0430\u043b\u0430\u043c"),theme:"default",onChange:function(t){return e.setState({filter:t})},value:e.state.filter}),e.renderTabs()),i.a.createElement(p.FormLayout,null,i.a.createElement(p.Group,{top:"\u0418\u043d\u0442\u0435\u0440\u0432\u0430\u043b \u043f\u043e\u0434\u043f\u0438\u0441\u043a\u0438: "+$[a.periodType-1],bottom:""},i.a.createElement(p.List,null,i.a.createElement(p.Div,null,i.a.createElement(p.Slider,{step:1,min:0,max:$.length,value:Number(a.periodType),onChange:function(e){return window.setGlobalState(function(t){return t.subscribingProcess.periodType=e>0?e:1,t})}})))),a.selected.publishers.length+a.selected.tags.length>0&&i.a.createElement(i.a.Fragment,null,i.a.createElement(p.Div,null,i.a.createElement(p.Button,{level:"outline",className:"pay-subscribtion",onClick:function(){window.setGlobalState(function(e){return e.previewFeedMode={publishers:e.subscribingProcess.selected.publishers,tags:e.subscribingProcess.selected.tags},e}),e.props.open("feed")}},"\u041f\u043e\u0441\u043c\u043e\u0442\u0440\u0435\u0442\u044c \u043f\u0440\u0435\u0432\u044c\u044e \u0432\u0430\u0448\u0435\u0439 \u043d\u043e\u0432\u043e\u0441\u0442\u043d\u043e\u0439 \u043b\u0435\u043d\u0442\u044b")),i.a.createElement(p.Group,null,i.a.createElement(p.List,null,a.selected.publishers.concat(a.selected.tags).map(function(t){var r=e.state.publishers.concat(e.state.tags).find(function(e){return e.label==t});if(!r)return i.a.createElement(p.Cell,null,"-");var s=void 0!==e.state.tags.find(function(e){return e.label==t});return n+=te(r.price,a.periodType),i.a.createElement(p.Cell,null,(s?"#":"")+r.label," - ",te(r.price,a.periodType),"\u0440.",i.a.createElement(p.Button,{level:"outline",className:"remove-from-subscribtions-btn",onClick:function(){return window.setGlobalState(function(e){return e.subscribingProcess.selected[s?"tags":"publishers"].splice(e.subscribingProcess.selected[s?"tags":"publishers"].indexOf(r.label),1),e})}},"x"))}),i.a.createElement(p.Cell,null,i.a.createElement(p.Button,{className:"pay-subscribtion",onClick:function(){return e.subscribe()}},"\u041f\u043e\u043b\u0443\u0447\u0438\u0442\u044c \u043f\u043e\u0434\u043f\u0438\u0441\u043a\u0443 \u0437\u0430",0==r?" "+n+"\u0440.":i.a.createElement(i.a.Fragment,null," ",i.a.createElement("span",{className:"line-throw"},n,"\u0440.")," ",Math.round(n*(1-r)*100)/100,"\u0440.")))))),i.a.createElement(p.FormLayoutGroup,null,!(!e.state.fixedOverlay&&""!==e.state.filter)&&e.renderTabs(),e.state[e.state.tab].filter(function(t){return t.label.toLowerCase().includes(e.state.filter.toLowerCase())}).map(function(t){return i.a.createElement(p.Button,{level:"outline",className:"subscribe-source-btn",onClick:function(){return a.selected[e.state.tab].includes(t.label)?window.setGlobalState(function(e){return e}):window.setGlobalState(function(a){return a.subscribingProcess.selected[e.state.tab].push(t.label),a.subscribingProcess.manuallyChanged=!0,a})}},i.a.createElement("img",{className:"subscribe-pic",src:t.pic}),t.label," -",a.selected[e.state.tab].includes(t.label)?"\u0434\u043e\u0431\u0430\u0432\u043b\u0435\u043d\u043e":" "+te(t.price,a.periodType)+"\u0440.",i.a.createElement(p.Link,{onClick:function(a){a.stopPropagation(),window.setGlobalState({preview:Object.assign(t,{type:e.state.tab})}),e.props.open("channel-preview")}},i.a.createElement(_.a,null)))}))))})}}]),t}(i.a.Component),te=function(e,t){return e*t},ae=Object(p.platform)(),ne=function(e){function t(e){var a;return Object(c.a)(this,t),(a=Object(d.a)(this,Object(h.a)(t).call(this,e))).state={},a}return Object(g.a)(t,e),Object(u.a)(t,[{key:"render",value:function(){return i.a.createElement(p.Panel,{id:this.props.id},i.a.createElement(p.PanelHeader,{left:i.a.createElement(p.HeaderButton,{onClick:this.props.goBack},ae===p.IOS?i.a.createElement(m.a,null):i.a.createElement(f.a,null))},'\u041f\u043e\u043b\u0443\u0447\u0438\u0442\u044c "',this.props.article.title,'"'),i.a.createElement(p.Group,null,i.a.createElement(p.Div,{className:"text-center"},'\u0412\u044b \u043c\u043e\u0436\u0435\u0442\u0435 \u043f\u0440\u0438\u043e\u0431\u0440\u0435\u0441\u0442\u0438 \u0438\u0441\u043a\u043b\u044e\u0447\u0438\u0442\u0435\u043b\u044c\u043d\u044b\u0439 \u0434\u043e\u0441\u0442\u0443\u043f \u043a \u0441\u0442\u0430\u0442\u044c\u0435 "',this.props.article.title,'" \u0437\u0430'),i.a.createElement(p.Div,null,i.a.createElement(p.Button,{className:"pay-subscribtion"},this.props.article.price,"\u0440."))),i.a.createElement(p.Group,null,i.a.createElement(p.Div,null,"\u0422\u0430\u043a \u0436\u0435 \u0432\u044b \u043c\u043e\u0436\u0435\u0442\u0435 \u043f\u043e\u043b\u0443\u0447\u0438\u0442\u044c \u0434\u043e\u0441\u0442\u0443\u043f, \u0440\u0435\u043f\u043e\u0441\u0442\u043d\u0443\u0432 \u044d\u0442\u0443 \u0441\u0442\u0430\u0442\u044c\u044e \u0441\u0435\u0431\u0435 \u043d\u0430 \u0441\u0442\u0435\u043d\u0443",i.a.createElement("br",null),"(\u0422\u043e\u043b\u044c\u043a\u043e \u0434\u043b\u044f \u043f\u0443\u0431\u043b\u0438\u0447\u043d\u044b\u0445 \u0430\u043a\u043a\u0430\u0443\u043d\u0442\u043e\u0432)",i.a.createElement(p.Button,{level:"outline",className:"pay-subscribtion"},"\u0421\u0434\u0435\u043b\u0430\u0442\u044c \u0440\u0435\u043f\u043e\u0441\u0442"))))}}]),t}(i.a.Component),ie=Object(p.platform)(),re=function(e){function t(e){return Object(c.a)(this,t),Object(d.a)(this,Object(h.a)(t).call(this,e))}return Object(g.a)(t,e),Object(u.a)(t,[{key:"render",value:function(){var e=this;return i.a.createElement(p.Panel,{id:this.props.id},i.a.createElement(p.PanelHeader,{left:i.a.createElement(p.HeaderButton,{onClick:this.props.goBack},ie===p.IOS?i.a.createElement(m.a,null):i.a.createElement(f.a,null))},this.props.type," ",this.props.label),i.a.createElement(q.Consumer,null,function(t){var a=t.subscribingProcess.selected.tags.concat(t.subscribingProcess.selected.publishers).includes(t.preview.label);return i.a.createElement(i.a.Fragment,null,i.a.createElement(p.Div,null,i.a.createElement("img",{className:"subscribe-channel-pic",src:t.preview.pic})),i.a.createElement(p.Div,null,"tags"===t.preview.type?"\u0421\u043c\u0430\u0440\u0442-\u0442\u0435\u0433":"\u0410\u0432\u0442\u043e\u0440\u0441\u043a\u0438\u0435 \u0440\u0430\u0441\u0441\u044b\u043b\u043a\u0438 \u0438\u0437\u0434\u0430\u0442\u0435\u043b\u044f"," ",t.preview.label),i.a.createElement(p.Div,null,t.preview.description),i.a.createElement(p.Div,null,t.preview.price,"\u0440. \u0437\u0430 \u043d\u0435\u0434\u0435\u043b\u044e \u043f\u043e\u0434\u043f\u0438\u0441\u043a\u0438"),i.a.createElement(p.Div,{className:"double-buttons"},i.a.createElement(p.Button,{level:"outline",onClick:function(){window.setGlobalState(function(e){return e.previewFeedMode={tags:[],publishers:[]},e.previewFeedMode[t.preview.type]=[t.preview.label],e}),e.props.open("feed")}},"\u041f\u0440\u0435\u0432\u044c\u044e \u043f\u043e\u0441\u0442\u043e\u0432"),i.a.createElement(p.Button,{onClick:function(){e.props.goBack(),window.setGlobalState(function(e){return a?e.subscribingProcess.selected[t.preview.type].splice(e.subscribingProcess.selected[t.preview.type].indexOf(t.preview.label),1):e.subscribingProcess.selected[t.preview.type].push(t.preview.label),e})}},a?"\u0423\u0434\u0430\u043b\u0438\u0442\u044c \u0438\u0437 \u043f\u043e\u0434\u043f\u0438\u0441\u043a\u0438":"\u0414\u043e\u0431\u0430\u0432\u0438\u0442\u044c \u0432 \u043f\u043e\u0434\u043f\u0438\u0441\u043a\u0443")))}))}}]),t}(i.a.Component),se=a(212),le=Object(p.platform)(),oe=function(e){function t(e){var a;return Object(c.a)(this,t),(a=Object(d.a)(this,Object(h.a)(t).call(this,e))).state={name:"\u0411\u0443\u043c\u0430\u0433\u0430",subscribers:12,profit:1e3,tags:[{label:"\u041f\u043e\u043b\u0438\u0442\u0438\u043a\u0430",value:60},{label:"\u0423\u0440\u0431\u0430\u043d\u0438\u0441\u0442\u0438\u043a\u0430",value:20},{label:"\u041c\u0435\u043c\u044b",value:10},{label:"\u041e\u0447\u0435\u043d\u044c \u0432\u0430\u0436\u043d\u044b\u0439 \u0442\u0435\u0433",value:10}],channels:[]},a}return Object(g.a)(t,e),Object(u.a)(t,[{key:"componentDidMount",value:function(){var e=this;E.a.get("".concat(window.getGlobalState().apiUrl,"/tagsAndPublishers")).then(function(t){console.log(t.data.result);var a=t.data.result.publishers;e.setState({channels:a.filter(function(e){return e.userProfile.id==window.getGlobalState().auth.id}).map(function(e){return e.label})})}).catch(console.log)}},{key:"render",value:function(){var e=this,t=Object(S.a)(e.state.tags).sort(function(e,t){return e.value>t.value?-1:1}).slice(0,15);return i.a.createElement(p.Panel,{id:this.props.id},i.a.createElement(p.PanelHeader,{left:i.a.createElement(p.HeaderButton,{onClick:this.props.goBack},le===p.IOS?i.a.createElement(m.a,null):i.a.createElement(f.a,null))},this.props.type," ",this.props.label),i.a.createElement(p.Group,null,i.a.createElement(p.List,null,i.a.createElement(p.Cell,{className:"text-center"},i.a.createElement(p.Header,{className:"display-block-header"},this.state.channels.map(function(e){return i.a.createElement("p",null,e)})),i.a.createElement("small",null,1===this.state.channels.length?"\u0410\u0432\u0442\u043e\u0440\u0441\u043a\u0438\u0439 \u043a\u0430\u043d\u0430\u043b":"\u0410\u0432\u0442\u043e\u0440\u0441\u043a\u0438\u0435 \u043a\u0430\u043d\u0430\u043b\u044b")))),i.a.createElement(se.a,{width:200,data:{labels:t.map(function(e){return e.label}),datasets:[{data:t.map(function(e){return e.value}),backgroundColor:["PeachPuff","DarkSalmon","PapayaWhip","LightYellow","Khaki","MediumPurple","DarkViolet","LightSalmon","IndianRed","LemonChiffon","Salmon","DarkOrchid","Moccasin","LightGoldenrodYellow","BlueViolet","PaleGoldenrod","LightCoral","DarkKhaki"]}]}}),i.a.createElement(p.Div,{className:"text-center"},"\u0421\u0430\u043c\u044b\u0435 \u043f\u0440\u0438\u0431\u044b\u043b\u044c\u043d\u044b\u0435 \u0442\u0435\u0433\u0438"),i.a.createElement(p.Group,null,i.a.createElement(p.List,null,i.a.createElement(p.Div,{className:"text-center"},"\u0411\u0430\u043b\u0430\u043d\u0441: ",i.a.createElement("span",{className:"publisher-profit"},this.state.profit,"\u0440."),i.a.createElement("br",null),i.a.createElement("br",null),i.a.createElement("small",null,"\u0417\u0430\u043f\u0440\u043e\u0441\u0438\u0442\u044c \u0432\u044b\u0432\u043e\u0434")))),i.a.createElement(p.Div,{className:"double-buttons"},i.a.createElement(p.Button,{level:"outline",onClick:function(){window.setGlobalState(function(t){return t.previewFeedMode={tags:[],publishers:[]},t.previewFeedMode.publishers=[e.state.name],t}),e.props.open("feed")}},"\u0418\u0441\u0442\u043e\u0440\u0438\u044f \u0432\u0441\u0435\u0445 \u043f\u043e\u0441\u0442\u043e\u0432"),i.a.createElement(p.Button,{onClick:function(){return e.props.open("article-editor")}},"\u0421\u043e\u0437\u0434\u0430\u0442\u044c \u043d\u043e\u0432\u044b\u0439 \u043f\u043e\u0441\u0442")))}}]),t}(i.a.Component),ce=[],ue=["home"],de=[],he={},ge=function(){for(var e=0;e<ce.length;e++){(0,ce[e])(ue)}},pe={subscribe:function(e){ce.push(e)},go:function(e){ue.push(e),ge(),B({page:ue.slice(-1)[0]})},back:function(){ue.length>1&&ue.splice(ue.length-1,1),ge(),B({page:ue.slice(-1)[0]})},init:function(e){de=e.initOpenAllowed,he=e.onInitRedirect;var t=D();void 0!==t.page&&(de.includes(t.page)?(ue.push(t.page),ge()):void 0!==he[t.page]&&(ue.push(he[t.page]),ge()))}},be=a(12),me=a(123),Ae=a(214),fe=a.n(Ae),ve=(a(576),Object(p.platform)()),Ee=function(e){function t(e){var a;return Object(c.a)(this,t),(a=Object(d.a)(this,Object(h.a)(t).call(this,e))).quillRef=i.a.createRef(),a.state={article:[],editor:"",tags:[],newTag:"",newTagModalVisible:!1,availibleChannels:[],selectedPublishers:"",title:""},a}return Object(g.a)(t,e),Object(u.a)(t,[{key:"componentDidMount",value:function(){var e=this;E.a.get("".concat(window.getGlobalState().apiUrl,"/tagsAndPublishers")).then(function(t){console.log(t.data.result);var a=t.data.result.publishers;e.setState({availibleChannels:a.filter(function(e){return e.userProfile.id==window.getGlobalState().auth.id}).map(function(e){return e.label})})}).catch(console.log)}},{key:"publish",value:function(){var e=this,t=Object(me.convertToRaw)(this.state.editor.getCurrentContent()),a=fe()(t),n={article:{title:this.state.title,tags:this.state.tags,paragraphs:a,publisher:this.state.selectedPublishers},publisherId:window.getGlobalState().auth.id};console.log(n),E.a.post("".concat(window.getGlobalState().apiUrl,"/article"),n).then(function(t){e.props.goBack()}).catch(function(e){console.log(e)})}},{key:"render",value:function(){var e=this;return i.a.createElement(p.Panel,{id:this.props.id},i.a.createElement(p.PanelHeader,{left:i.a.createElement(p.HeaderButton,{onClick:this.props.goBack},ve===p.IOS?i.a.createElement(m.a,null):i.a.createElement(f.a,null))},"\u0421\u043e\u0437\u0434\u0430\u0442\u044c \u0441\u0442\u0430\u044c\u044e"),i.a.createElement(p.Select,{placeholder:"\u0412\u044b\u0431\u0435\u0440\u0438\u0442\u0435 \u043a\u0430\u043d\u0430\u043b \u043f\u0443\u0431\u043b\u0438\u0446\u0430\u0438\u0438",value:this.state.selectedPublishers,onChange:function(t){return e.setState({selectedPublishers:t.target.value})}},this.state.availibleChannels.map(function(e){return i.a.createElement("option",{value:e},e)})),i.a.createElement(p.Group,null,i.a.createElement(p.Input,{value:this.state.title,placeholder:"\u0417\u0430\u0433\u043e\u043b\u043e\u0432\u043e\u043a \u0441\u0442\u0430\u0442\u044c\u0438",onChange:function(t){return e.setState({title:t.target.value})}})),i.a.createElement(p.Group,{className:"quill-wrapper"},i.a.createElement(be.Editor,{editorState:this.state.editor,toolbarClassName:"toolbarClassName",wrapperClassName:"wrapperClassName",editorClassName:"editorClassName",onEditorStateChange:function(t){return e.setState({editor:t})},toolbar:we})),i.a.createElement(p.Group,null,i.a.createElement(p.Div,null,i.a.createElement("small",null,"\u0422\u0435\u0433\u0438 \u043a \u0441\u0442\u0430\u0442\u044c\u0435")),i.a.createElement(p.Div,null,this.state.tags.map(function(t){return i.a.createElement(p.Button,{className:"article-editor-tag",level:"outline",onClick:function(){return e.setState(function(e){return e.tags.splice(e.tags.indexOf(t),1),e})}},t)}),i.a.createElement(p.Button,{level:"outline",onClick:function(){return e.setState({newTagModalVisible:!0})}},"+"))),i.a.createElement(p.Div,{className:"double-buttons"},i.a.createElement(p.Button,{onClick:function(){return e.publish()}},"\u041e\u043f\u0443\u0431\u043b\u0438\u043a\u043e\u0432\u0430\u0442\u044c")),this.state.newTagModalVisible&&i.a.createElement(p.PopoutWrapper,{v:"center",h:"center",onClick:function(){return e.setState({newTagModalVisible:!1})}},i.a.createElement(p.Group,{className:"article-editor-tag-input",onClick:function(e){return e.stopPropagation()}},i.a.createElement("p",null,"\u0412\u0432\u0435\u0434\u0438\u0442\u0435 \u0442\u0435\u0433"),i.a.createElement(p.Input,{value:this.state.newTag,onChange:function(t){return e.setState({newTag:t.target.value})}}),i.a.createElement("br",null),i.a.createElement(p.Button,{onClick:function(){return e.setState({newTagModalVisible:!1,tags:e.state.tags.concat([e.state.newTag]),newTag:""})}},"\u0414\u043e\u0431\u0430\u0432\u0438\u0442\u044c"))))}}]),t}(i.a.Component),we={options:["inline","blockType","list","link","emoji","image","history"],inline:{inDropdown:!1,className:void 0,component:void 0,dropdownClassName:void 0,options:["bold","italic","underline"],bold:{icon:be.Editor.bold,className:void 0},italic:{icon:be.Editor.italic,className:void 0}},blockType:{inDropdown:!0,options:["Normal","H1","H2","Blockquote","Code"],className:void 0,component:void 0,dropdownClassName:void 0},list:{inDropdown:!1,className:void 0,component:void 0,dropdownClassName:void 0,options:["unordered","ordered","indent","outdent"],unordered:{icon:be.Editor.unordered,className:void 0},ordered:{icon:be.Editor.ordered,className:void 0},indent:{icon:be.Editor.indent,className:void 0},outdent:{icon:be.Editor.outdent,className:void 0}},textAlign:{inDropdown:!1,className:void 0,component:void 0,dropdownClassName:void 0,options:["left","center","right","justify"],left:{icon:be.Editor.left,className:void 0},center:{icon:be.Editor.center,className:void 0},right:{icon:be.Editor.right,className:void 0},justify:{icon:be.Editor.justify,className:void 0}},colorPicker:{icon:be.Editor.color,className:void 0,component:void 0,popupClassName:void 0,colors:["rgb(97,189,109)","rgb(26,188,156)","rgb(84,172,210)","rgb(44,130,201)","rgb(147,101,184)","rgb(71,85,119)","rgb(204,204,204)","rgb(65,168,95)","rgb(0,168,133)","rgb(61,142,185)","rgb(41,105,176)","rgb(85,57,130)","rgb(40,50,78)","rgb(0,0,0)","rgb(247,218,100)","rgb(251,160,38)","rgb(235,107,86)","rgb(226,80,65)","rgb(163,143,132)","rgb(239,239,239)","rgb(255,255,255)","rgb(250,197,28)","rgb(243,121,52)","rgb(209,72,65)","rgb(184,49,47)","rgb(124,112,107)","rgb(209,213,216)"]},link:{inDropdown:!1,className:void 0,component:void 0,popupClassName:void 0,dropdownClassName:void 0,showOpenOptionOnHover:!0,defaultTargetOption:"_self",options:["link","unlink"],link:{icon:be.Editor.link,className:void 0},unlink:{icon:be.Editor.unlink,className:void 0}},emoji:{icon:be.Editor.emoji,className:void 0,component:void 0,popupClassName:void 0,emojis:["\ud83d\ude00","\ud83d\ude01","\ud83d\ude02","\ud83d\ude03","\ud83d\ude09","\ud83d\ude0b","\ud83d\ude0e","\ud83d\ude0d","\ud83d\ude17","\ud83e\udd17","\ud83e\udd14","\ud83d\ude23","\ud83d\ude2b","\ud83d\ude34","\ud83d\ude0c","\ud83e\udd13","\ud83d\ude1b","\ud83d\ude1c","\ud83d\ude20","\ud83d\ude07","\ud83d\ude37","\ud83d\ude08","\ud83d\udc7b","\ud83d\ude3a","\ud83d\ude38","\ud83d\ude39","\ud83d\ude3b","\ud83d\ude3c","\ud83d\ude3d","\ud83d\ude40","\ud83d\ude48","\ud83d\ude49","\ud83d\ude4a","\ud83d\udc7c","\ud83d\udc6e","\ud83d\udd75","\ud83d\udc82","\ud83d\udc73","\ud83c\udf85","\ud83d\udc78","\ud83d\udc70","\ud83d\udc72","\ud83d\ude4d","\ud83d\ude47","\ud83d\udeb6","\ud83c\udfc3","\ud83d\udc83","\u26f7","\ud83c\udfc2","\ud83c\udfcc","\ud83c\udfc4","\ud83d\udea3","\ud83c\udfca","\u26f9","\ud83c\udfcb","\ud83d\udeb4","\ud83d\udc6b","\ud83d\udcaa","\ud83d\udc48","\ud83d\udc49","\ud83d\udc49","\ud83d\udc46","\ud83d\udd95","\ud83d\udc47","\ud83d\udd96","\ud83e\udd18","\ud83d\udd90","\ud83d\udc4c","\ud83d\udc4d","\ud83d\udc4e","\u270a","\ud83d\udc4a","\ud83d\udc4f","\ud83d\ude4c","\ud83d\ude4f","\ud83d\udc35","\ud83d\udc36","\ud83d\udc07","\ud83d\udc25","\ud83d\udc38","\ud83d\udc0c","\ud83d\udc1b","\ud83d\udc1c","\ud83d\udc1d","\ud83c\udf49","\ud83c\udf44","\ud83c\udf54","\ud83c\udf64","\ud83c\udf68","\ud83c\udf6a","\ud83c\udf82","\ud83c\udf70","\ud83c\udf7e","\ud83c\udf77","\ud83c\udf78","\ud83c\udf7a","\ud83c\udf0d","\ud83d\ude91","\u23f0","\ud83c\udf19","\ud83c\udf1d","\ud83c\udf1e","\u2b50","\ud83c\udf1f","\ud83c\udf20","\ud83c\udf28","\ud83c\udf29","\u26c4","\ud83d\udd25","\ud83c\udf84","\ud83c\udf88","\ud83c\udf89","\ud83c\udf8a","\ud83c\udf81","\ud83c\udf97","\ud83c\udfc0","\ud83c\udfc8","\ud83c\udfb2","\ud83d\udd07","\ud83d\udd08","\ud83d\udce3","\ud83d\udd14","\ud83c\udfb5","\ud83c\udfb7","\ud83d\udcb0","\ud83d\udd8a","\ud83d\udcc5","\u2705","\u274e","\ud83d\udcaf"]},image:{icon:be.Editor.image,className:void 0,component:void 0,popupClassName:void 0,urlEnabled:!0,uploadEnabled:!0,alignmentEnabled:!0,uploadCallback:void 0,previewImage:!1,inputAccept:"image/gif,image/jpeg,image/jpg,image/png,image/svg",alt:{present:!1,mandatory:!1},defaultSize:{height:"auto",width:"auto"}},history:{inDropdown:!1,className:void 0,component:void 0,dropdownClassName:void 0,options:["undo","redo"],undo:{icon:be.Editor.undo,className:void 0},redo:{icon:be.Editor.redo,className:void 0}}},Se=function(e){function t(e){var a;return Object(c.a)(this,t),(a=Object(d.a)(this,Object(h.a)(t).call(this,e))).state={activePanel:D().page||"home",fetchedUser:null,auth:!1},pe.subscribe(function(e){return a.setState({activePanel:e.slice(-1)[0]})}),a}return Object(g.a)(t,e),Object(u.a)(t,[{key:"auth",value:function(e){var t=this;this.state.auto||E.a.post(window.getGlobalState().apiUrl+"/autorizeUser",{userProfile:e}).then(function(e){t.setState({auth:!0}),e.data.success&&e.data.result.subscriptions.tags.length+e.data.result.subscriptions.publishers.length>0?window.setGlobalState({currentSubscribtion:e.data.result.subscriptions}):window.setGlobalState({currentSubscribtion:{tags:[],publishers:[]}})}).catch(console.log)}},{key:"componentDidMount",value:function(){var e=this;pe.subscribe(function(t){return e.setState({activePanel:t.slice(-1)[0]})}),pe.init({initOpenAllowed:["home","feed","article","subscribe","publisher-account","article-editor"],onInitRedirect:{"get-one-article":"article","channel-preview":"subscribe","preview-feed":"home"}}),o.a.subscribe(function(t){switch(t.detail.type){case"VKWebAppGetUserInfoResult":e.setState({fetchedUser:t.detail.data}),window.setGlobalState({auth:{user_id:t.detail.data.id,signed_user_id:t.detail.data.signed_user_id}}),e.auth({user_id:t.detail.data.id,signed_user_id:t.detail.data.signed_user_id})}}),o.a.send("VKWebAppGetUserInfo",{})}},{key:"render",value:function(){return i.a.createElement(q.Provider,null,this.state.auth?i.a.createElement(p.View,{activePanel:this.state.activePanel},i.a.createElement(w,{id:"home",fetchedUser:this.state.fetchedUser,open:pe.go,goBack:pe.back}),i.a.createElement(J,{id:"feed",fetchedUser:this.state.fetchedUser,open:pe.go,goBack:pe.back}),i.a.createElement(V,{id:"article",open:pe.go,user:this.state.fetchedUser,goBack:pe.back}),i.a.createElement(ee,{id:"subscribe",open:pe.go,articleData:this.state.currentArticleData,goBack:pe.back}),i.a.createElement(ne,{id:"get-one-article",open:pe.go,article:this.state.currentArticleData,goBack:pe.back}),i.a.createElement(re,{id:"channel-preview",open:pe.go,goBack:pe.back}),i.a.createElement(oe,{id:"publisher-account",open:pe.go,goBack:pe.back}),i.a.createElement(Ee,{id:"article-editor",open:pe.go,goBack:pe.back})):i.a.createElement(p.Div,null,i.a.createElement(p.Spinner,null)))}}]),t}(i.a.Component);function ye(e){navigator.serviceWorker.register(e).then(function(e){e.onupdatefound=function(){var t=e.installing;t.onstatechange=function(){"installed"===t.state&&(navigator.serviceWorker.controller?console.log("New content is available; please refresh."):console.log("Content is cached for offline use."))}}}).catch(function(e){console.error("Error during service worker registration:",e)})}var ke=Boolean("localhost"===window.location.hostname||"[::1]"===window.location.hostname||window.location.hostname.match(/^127(?:\.(?:25[0-5]|2[0-4][0-9]|[01]?[0-9][0-9]?)){3}$/));o.a.send("VKWebAppInit",{}),function(){if("serviceWorker"in navigator){if(new URL("",window.location).origin!==window.location.origin)return;window.addEventListener("load",function(){var e="".concat("","/service-worker.js");ke?(function(e){fetch(e).then(function(t){404===t.status||-1===t.headers.get("content-type").indexOf("javascript")?navigator.serviceWorker.ready.then(function(e){e.unregister().then(function(){window.location.reload()})}):ye(e)}).catch(function(){console.log("No internet connection found. App is running in offline mode.")})}(e),navigator.serviceWorker.ready.then(function(){console.log("This web app is being served cache-first by a service worker. To learn more, visit https://goo.gl/SC7cgQ")})):ye(e)})}}(),s.a.render(i.a.createElement(Se,null),document.getElementById("root"))}},[[215,2,1]]]);
//# sourceMappingURL=main.210c117d.chunk.js.map